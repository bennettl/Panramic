$(document).ready(function(){hdClear();feedContainer();sideNav()});function listOverlay(b,a){$(b+" .mediumList li img").live("mouseenter",function(){var c=$(this).parent();var e=$(this).position().left;var d=$(this).position().top;$(a).css({top:d,left:e,display:"block"}).appendTo(c)});$(a).live("mouseleave",function(){$(this).hide()})}function feedNoti(){if($("#feedList > li:visible").length>0){$("#feedNoti").hide()}else{if($("#filterOn.current").length==1){$("#feedNoti").text("There are currently no matched events").fadeIn(500)}else{$("#feedNoti").text("There are currently no new events").fadeIn(500)}}}function filterPersist(){if($("#filterOn.current").length==1){$("#feedList > li").hide();$("#sidenavBottom .miniList > li").has("div.filterBox:not(:visible)").each(function(){var a=$(this).parents("ul").attr("id");var b=parseInt($(this).attr("value"));switch(a){case"networkList":$("#feedList > li.network"+b).show();break;case"fieldList":$("#feedList > li.field"+b).show();break;case"groupList":$("#feedList > li.group"+b).show();break;default:break}})}}function emptyValidation(e,d){for(var b=0;b<e.length;b++){var a=e[b];var c=$("[name='"+a+"']").val().replace(/\s/g,"");if(c==""){switch(d){case"event":errorMsg="Please enter the event "+a;break;case"group":errorMsg="Please enter your group "+a;break;default:errorMsg="Please fill in the require fields";break}}}}function feedContainer(){navCurrent("#timeline","#timeline a");feedToggle();filterPersist();feedNoti();deleteHover(".feed");$("#timeline a").click(function(){var b=$(this).attr("id");var a=$(this).parents("#timeline").siblings("#feedList").attr("class");var c=($("#foodOn.current").length==1)?"freeFood=true&":"";c+=b+"=true";c=($(this).attr("href").indexOf("facebook")>-1)?c+"&facebook=true":c+"&facebook=false";$("#friendTip").appendTo("#leftContainer").hide();$("#deleteTip").appendTo("#leftContainer").hide();$("#loading").show();$.post("home."+a+".php",c,function(d){var f=$(d).find("#feedList");$("#loading").hide();$("#pageList").remove();$("#feedList").replaceWith(f);$("#feedList").hide().fadeIn(500);feedToggle();filterPersist();feedNoti();if(b=="myCal"){var e=$(d).find("#pageList");e.insertBefore("#feedList");$("#pageList").hide().fadeIn(500);pageList()}},"html")})}function textCounter(c){var d=2000;var b=$(c).val().length;var a=d-b;$(c).parents("table").find(".tcCount").text(a);$(c).keydown(function(f){var h=f.which;var g=$(c).val().length;var e=d-g;if((g>=d)&&(h!=8)){return false}$(c).parents("table").find(".tcCount").text(e)})}function adjustHeight(b){var a=$(b);var c=a.scrollTop("9999").scrollTop()+60;a.css("height",c)}function searchSuggest(c,b){switch(c.which){case 38:a(-1);break;case 40:a(1);break;case 13:d();break;case 8:f();break;default:e();break}$("#searchList li").live("click",function(){d()});$("#searchList li").live("mouseover",function(){$(this).siblings("[class='searchSelect']").removeClass("searchSelect");$(this).addClass("searchSelect")});function e(){var h=$("#searchList li");var g=b.val().toLowerCase();$("#searchList, #searchList li").show();$("#searchList li.searchSelect").removeClass();h.each(function(){if($(this).text().toLowerCase().indexOf(g)==-1){$(this).hide()}});var j=parseInt(b.position().top);var i=Math.ceil(parseInt(b.position().left));$("#searchList").css({top:j+26+"px",left:i+"px"});$("#searchList li:visible:first").addClass("searchSelect")}function a(h){var g=$("#searchList li:visible");g.each(function(i){if($(this).hasClass("searchSelect")){$(this).removeClass();currentCount=i+h}});switch(currentCount){case -1:currentCount=parseInt(g.length)-1;$("#searchList li:visible:last").addClass("searchSelect");break;case parseInt(g.length):currentCount=0;$("#searchList li:visible:first").addClass("searchSelect");break;default:$("#searchList li:visible:eq("+currentCount+")").addClass("searchSelect")}}function d(g){var h=$("#searchList li:visible");h.each(function(){if($(this).hasClass("searchSelect")){b.val($(this).text());$("#"+b.attr("name")).val($(this).attr("value"));$("#searchList").hide()}})}function f(){if(b.val()==""){$("#"+b.attr("name")).removeAttr("value");$("#searchList").hide()}else{e()}}}function inbox(){msgTimer();a("35px");textExpand(".msgTextarea");textExpand(".commentText");fadeInSubmit(".commentText",".commentSubmit");deleteHover(".msgFeed");deleteHover(".msgReply");$("#newMsgBtn").toggle(function(){$("#newMsgContainer").show();$("#newMsgContainer input[name='msgTo']").focus()},function(){$("#newMsgContainer").hide();$("#msgNoti").hide();$("#newMsgContainer input[name='msgTo']").blur()});$("#inbox .moreInfo").toggle(function(){$(this).siblings(".msgBody").css("height","auto");$(this).parents(".msgMainContainer").siblings().show();$(this).text("hide");return false},function(){var b=$(this).siblings(".msgBody");if(b.text().length>300){b.css("height","35px")}else{b.removeAttr("height")}$(this).parents(".msgMainContainer").siblings(":not('.delete')").hide();$(this).text("more...");return false});$("#newMsgForm").submit(function(){var b=$("[name='msgToVal']").val();var c=$("[name='msgContent']").val();if(b!=""&&c!=""){var d=$(this).serialize()+"&newMsgForm=true";$("#msgNoti").text("Message Sent!").show();$("[name='msgToVal']").val("");$("#newMsgReset").click();$.post("ajax/ajax.inbox.php",d)}else{if(b==""){$("#msgNoti").text("Please specify a valid recipient").show()}else{if(c==""){$("#msgNoti").text("Please write a message").show()}}}return false});$("#inbox #removeBtn").live("click",function(){if($(this).parents(".msgReply").length==1){var c=$(this).parents(".msgReply").attr("value");$("#deleteTip").hide();$(this).parents(".msgReply").hide();$.post("ajax/ajax.inbox.php",{removeMsgReply:"true",msgReplyId:c})}else{if($(this).parents(".msgFeed").length==1){var d=$(this).parents(".msgFeed").attr("value");var b=$("<div class='notification'>Message removed</div>");$("#deleteTip").appendTo("#leftContainer").hide();$(".msgFeed").has(".delete.current").replaceWith(b);$.post("ajax/ajax.inbox.php",{removeMsg:"true",msgId:d})}}return false});$("#inbox #reportBtn").live("click",function(){if($(".msgReport").length==0){var c=$(this).parents(".msgFeed").attr("value");var b=$(window).scrollTop()+50;$("#reportMod").css("top",b+"px").show();$(this).parents(".msgFeed").addClass("msgReport");$("#reportForm").find("[name='msgId']").val(c);$(".delete.current").removeClass("current");$("#deleteTip").appendTo("#leftContainer").hide()}return false});$("#inbox .commentForm").submit(function(){var d=$(this).children(".commentText").val().replace(/\s/g,"");if(d!=""){var d=$(this).children(".commentText").val();var c=$(this).serialize()+"&inboxReply=true";var b=templateMsgReply(d);b.appendTo($(this).parents(".commentContainer").siblings(".msgReplyContainer")).hide().fadeIn(500);$(this).children(".commentText").val("");$.post("ajax/ajax.inbox.php",c)}return false});$("#inbox input[name='msgTo']").keyup(function(c){var b=$(this);searchSuggest(c,b)});function a(){$(".msgMainContainer .msgBody").each(function(){if($(this).height()>35){$(this).height("35px")}})}}function eventinv(){$("#eventInv .mediumList > li:odd").hide();listOverlay("#eventInv","#deleteList");if($("#eventInv .mediumList > li").length>0){var b=$("#eventInv .mediumList > li:eq(1)").clone(true,true);var c=$("#eventInv .mediumList > li:eq(1) .friendName").text();var a=$("#eventInv .mediumList > li:eq(1) .friendHref").text();$("#eventInv .pageNoti").attr("id","friendText").html('<a href="'+a+'">'+c+"</a> invited you to...");b.appendTo("#eventInv #invContainer").show();feedToggle()}else{$("#eventInv .pageNoti").text("There are currently no event invites").show()}$("#eventInv #deleteList").click(function(){var e=$(this).parents("li").next("li.feed").clone(true,true).show();var f=e.find(".friendName").text();var d=e.find(".friendHref").text();$("#friendText").html('<a href="'+d+'">'+f+"</a> invited you to...");$(this).hide();$("#eventInv #invContainer").html(e).hide().fadeIn(500);feedToggle()});$("#eventInv .deleteBox").click(function(e){e.stopPropagation();var f=$(this).parents("li").attr("value");var d=$("<li class='notification'>Invite removed</li>");if($("#invContainer > li").attr("value")==f){$("#invContainer > li").replaceWith(d)}$("#friendText").text("");$(this).parents("li").hide();$.post("ajax/ajax.eventInv.php",{deleteEvtInv:"true",eventId:f})});$("#eventInv .moreInfo").click(function(){$("#deleteList").hide()})}function friendReq(){listOverlay("#friendReq","#confirmBox");if($("#friendReq li").length==0){$("#friendReq #friendNoti").show()}$("#friendReq .confirmBtn").live("click",function(){var a=$("<li><div class='listNote'>Friend Confirmed</div></li>");var b=$(this).parents("li").attr("value");$(this).parents("li").addClass("selected");$(this).parents("#confirmBox").appendTo("#friendReq").hide();$("#friendReq .selected").replaceWith(a);$.post("ajax/ajax.friendReq.php",{confirmFriend:"true",friendId:b})});$("#friendReq .deleteBox").live("click",function(){var a=$(this).parents("li").attr("value");$(this).parents("li").hide();$(this).parent().hide();$.post("ajax/ajax.friendReq.php",{ignoreFriend:"true",friendId:a})})}function groupSubmit(){$(".guestListContainer > div:not(':first')").hide();textExpand("[name='description']");fileInput();$("#groupSubmitForm").submit(function(){var b=new Array("name","location","description");var c=$("#groupSubmitForm .inputFile").val();var a=$("#groupSubmitForm .fileText").val();errorMsg="";emptyValidation(b,"group");if($("input[name='name']").val().length>40){errorMsg="Group name can't be longer than 40 characters"}if($("input[name='network[]']:checked").length==0&&$("input[name='field[]']:checked").length==0){errorMsg="Please select the general networks/ fields your group belongs to"}if(validateEmail($("[name='email']"))){errorMsg=validateEmail($("[name='email']"))}if(validateFile(c)){errorMsg=validateFile(c)}if(a==""){errorMsg="Please select your main group photo"}if(errorMsg==""){$("#groupSubmitFrame").load(function(){var e=$("#groupSubmitFrame").contents().find("div#success").text();var d=$("#groupSubmitFrame").contents().find("div#message").text();$("#groupSubmitNoti").text(d).show();if(e=="yes"){$("#groupSubmitForm").hide();$("#groupSubmitNoti2").text("Thank you for submitting your group! We will confirm your submission shortly.")}})}else{$("#groupSubmitNoti").text(errorMsg).show()}})}function sideNav(){navCurrent("#sidenavTop","#sidenavTop li a");$("#sidenavTop a").click(function(){var a=$(this).attr("id").substring(4);var b="home."+a+".php";$("#friendTip").appendTo("#leftContainer").hide();$("#deleteTip").appendTo("#leftContainer").hide();$("#contentContainer").hide();$("#feedNoti").hide();$("#loading").show();$(".mod").hide();if($("#foodOn.current").length==1){$("#foodOn").removeClass("current");$("#foodOff").addClass("current")}if($(".firstImg").length==2){$(".firstImg").hide()}switch(a){case"userFeed":case"friendFeed":case"everyFeed":$("#contentContainer").load(b,{},function(){$("#loading").hide();$(this).hide().fadeIn(500);feedContainer()});break;case"inbox":$("#contentContainer").load(b,{},function(){$("#loading").hide();$(this).hide().fadeIn(500);inbox();$("#pageList a").click(function(){inbox()});pageList()});break;case"groupBuffer1":case"groupBuffer2":case"groupBuffer3":$("#contentContainer").load("home.groupBuffer.php",{},function(){$("#loading").hide();$(this).hide().fadeIn(500);groupBuffer()});break;default:$("#contentContainer").load(b,{},function(){$("#loading").hide();$(this).hide().fadeIn(500);window[a]()});break}});$("#sidenavBottom .filterBox ").live("mouseover",function(){var a=($(this).siblings("i").length==1)?$(this).siblings("i").attr("class"):$(this).siblings("a").find("img").attr("alt");var c=$(this).offset().left;var b=$(this).offset().top;$("#sideTip").appendTo("body").css({top:b+1+"px",left:c+34+"px"}).text(a);$("#sideTip").show()});$("#sidenavBottom .filterBox ").live("mouseout",function(){$("#sideTip").appendTo("#container").hide()});$("#filterOn").click(function(){if($(".filterBox").length==0){$("#sidenavBottom li").each(function(){$("<div class='filterBox'></div>").appendTo($(this))})}$("#feedList > li").hide();$(".miniList > li i").css("cursor","pointer");$("#filterOff").removeClass("current");$(this).addClass("current");if($("#tab_userFeed.current").length==1||$("#tab_friendFreed.current").length==1||$("#tab_everyFeed.current").length==1){feedNoti()}});$("#filterOff").click(function(){$(".filterBox").remove();$("#feedList > li").show();$(".miniList > li i").css("cursor","default");$("#filterOn").removeClass("current");$(this).addClass("current");if($("#tab_userFeed.current").length==1||$("#tab_friendFreed.current").length==1||$("#tab_everyFeed.current").length==1){feedNoti()}});$(".filterBox").live("click",function(){var a=$(this).parents("ul").attr("id");var b=parseInt($(this).parent("li").attr("value"));switch(a){case"networkList":$("#feedList > li.network"+b).fadeIn(500);break;case"fieldList":$("#feedList > li.field"+b).fadeIn(500);break;case"groupList":$("#feedList > li.group"+b).fadeIn(500);break;default:break}$(this).hide();feedNoti()});$(".miniList > li > i").click(function(){if($("#filterOn.current").length==1){var a=$(this).parents("ul").attr("id");var b=$(this).parent("li").attr("value");switch(a){case"networkList":$("#feedList > li.network"+b).hide();break;case"fieldList":$("#feedList > li.field"+b).hide();break;default:break}$(this).siblings(".filterBox").show()}feedNoti()});$("#groupList a").click(function(){if($("#filterOn.current").length==1){var a=$(this).parent("li").attr("value");$("#feedList > li.group"+a).hide();$(this).siblings(".filterBox").show();feedNoti();return false}});$("#foodOn").click(function(){$("#sidenavTop a.current").removeClass("current");$("#sidenavTop #tab_everyFeed").addClass("current");$("#contentContainer").load("home.everyFeed.php",{freeFood:"true"},function(){feedContainer()}).hide().fadeIn(500);$("#foodOff").removeClass("current");$(this).addClass("current")});$("#foodOff").click(function(){if($(".everyFeed").length==1){$("#tab_everyFeed").click();$("#foodOn").removeClass("current");$(this).addClass("current")}})};